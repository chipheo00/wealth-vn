"use strict";(self.webpackChunkwealthvn_docs=self.webpackChunkwealthvn_docs||[]).push([[6014],{6801(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"development/goals/projected-value-business-logic","title":"Projected Value Business Logic","description":"Overview","source":"@site/docs/development/goals/projected-value-business-logic.md","sourceDirName":"development/goals","slug":"/development/goals/projected-value-business-logic","permalink":"/wealth-vn/docs/development/goals/projected-value-business-logic","draft":false,"unlisted":false,"editUrl":"https://github.com/chipheo00/vn-wealthfolio/tree/main/docs/docs/development/goals/projected-value-business-logic.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Goal Detail Page","permalink":"/wealth-vn/docs/development/goals/goal-details-page"},"next":{"title":"VN Market Assets Synchronization","permalink":"/wealth-vn/docs/development/vn-market/vn-assets-synchronization"}}');var r=t(6070),s=t(8193);const i={},a="Projected Value Business Logic",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Compounding Approaches",id:"compounding-approaches",level:2},{value:"Core Formula (Monthly Compounding)",id:"core-formula-monthly-compounding",level:2},{value:"Why Monthly Compounding?",id:"why-monthly-compounding",level:3},{value:"Why Not Include Initial Contribution?",id:"why-not-include-initial-contribution",level:3},{value:"Alternative Formula: Daily Compounding",id:"alternative-formula-daily-compounding",level:2},{value:"Daily Compounding Formula",id:"daily-compounding-formula",level:3},{value:"When to Use Daily Compounding",id:"when-to-use-daily-compounding",level:3},{value:"Precision Difference",id:"precision-difference",level:3},{value:"Calculation Details (Current Implementation)",id:"calculation-details-current-implementation",level:2},{value:"1. Parameter Conversion",id:"1-parameter-conversion",level:3},{value:"2. Time Calculation",id:"2-time-calculation",level:3},{value:"3. Compound Factor",id:"3-compound-factor",level:3},{value:"4. Future Value Calculation",id:"4-future-value-calculation",level:3},{value:"Implementation Locations",id:"implementation-locations",level:2},{value:"1. goal-utils.ts - calculateProjectedValue()",id:"1-goal-utilsts---calculateprojectedvalue",level:3},{value:"2. goal-utils.ts - Daily Compounding Functions",id:"2-goal-utilsts---daily-compounding-functions",level:3},{value:"<code>getDaysDiff(startDate, endDate)</code>",id:"getdaysdiffstartdate-enddate",level:4},{value:"<code>calculateProjectedValueByDate(startValue, monthlyInvestment, annualReturnRate, startDate, currentDate)</code>",id:"calculateprojectedvaluebydatestartvalue-monthlyinvestment-annualreturnrate-startdate-currentdate",level:4},{value:"<code>isGoalOnTrackByDate(currentValue, startValue, monthlyInvestment, annualReturnRate, startDate)</code>",id:"isgoalontrackbydatecurrentvalue-startvalue-monthlyinvestment-annualreturnrate-startdate",level:4},{value:"4. goal-details-page.tsx",id:"4-goal-details-pagetsx",level:3},{value:"5. use-goal-valuation-history.ts",id:"5-use-goal-valuation-historyts",level:3},{value:"Calculation Scenarios",id:"calculation-scenarios",level:2},{value:"Scenario 1: No Monthly Investment, No Return",id:"scenario-1-no-monthly-investment-no-return",level:3},{value:"Scenario 2: Monthly Investment, No Return",id:"scenario-2-monthly-investment-no-return",level:3},{value:"Scenario 3: Monthly Investment + Return",id:"scenario-3-monthly-investment--return",level:3},{value:"Scenario 4: 1 Year Projection",id:"scenario-4-1-year-projection",level:3},{value:"Scenario 5: Multiple Years",id:"scenario-5-multiple-years",level:3},{value:"On-Track Determination",id:"on-track-determination",level:2},{value:"Example: On Track",id:"example-on-track",level:3},{value:"Example: Off Track",id:"example-off-track",level:3},{value:"Chart Rendering",id:"chart-rendering",level:2},{value:"Date Intervals",id:"date-intervals",level:3},{value:"Chart Data Points",id:"chart-data-points",level:3},{value:"Handling Incomplete Periods",id:"handling-incomplete-periods",level:3},{value:"Projected vs Actual Lines",id:"projected-vs-actual-lines",level:3},{value:"Special Cases",id:"special-cases",level:2},{value:"Case 1: Goal Not Started Yet",id:"case-1-goal-not-started-yet",level:3},{value:"Case 2: No Monthly Investment",id:"case-2-no-monthly-investment",level:3},{value:"Case 3: Negative Return Rate",id:"case-3-negative-return-rate",level:3},{value:"Data Dependencies",id:"data-dependencies",level:2},{value:"use-goal-progress.ts",id:"use-goal-progressts",level:3},{value:"use-goal-valuation-history.ts",id:"use-goal-valuation-historyts",level:3},{value:"Validation Rules",id:"validation-rules",level:2},{value:"1. Monthly Investment Range",id:"1-monthly-investment-range",level:3},{value:"2. Annual Return Rate Range",id:"2-annual-return-rate-range",level:3},{value:"3. Start Date Before Due Date",id:"3-start-date-before-due-date",level:3},{value:"4. Projected Value Constraints",id:"4-projected-value-constraints",level:3},{value:"Testing Scenarios",id:"testing-scenarios",level:2},{value:"References",id:"references",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"projected-value-business-logic",children:"Projected Value Business Logic"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Projected Value represents the target amount a goal should reach by a given date\nbased on:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Regular monthly contributions"}),"\n",(0,r.jsx)(n.li,{children:"Expected annual return rate"}),"\n",(0,r.jsx)(n.li,{children:"Time elapsed from goal start date"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Key Principle:"})," Initial contributions are ",(0,r.jsx)(n.strong,{children:"excluded"})," from projection.\nProjected value is calculated purely from ",(0,r.jsx)(n.strong,{children:"monthly investment contributions"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"compounding-approaches",children:"Compounding Approaches"}),"\n",(0,r.jsx)(n.p,{children:"The system supports two projection methods for different use cases:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspect"}),(0,r.jsx)(n.th,{children:"Monthly Compounding"}),(0,r.jsx)(n.th,{children:"Daily Compounding"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"When Used"})}),(0,r.jsx)(n.td,{children:"Chart projections, goal form calculations"}),(0,r.jsx)(n.td,{children:"Current-date on-track determination"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Granularity"})}),(0,r.jsx)(n.td,{children:"Month-end dates only"}),(0,r.jsx)(n.td,{children:"Any specific date"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Precision"})}),(0,r.jsx)(n.td,{children:"~0.13% lower"}),(0,r.jsx)(n.td,{children:"~0.13% higher"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Function"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"calculateProjectedValue()"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"calculateProjectedValueByDate()"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Consistency"})}),(0,r.jsx)(n.td,{children:"Matches goal form setup"}),(0,r.jsx)(n.td,{children:"More realistic real-world"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"core-formula-monthly-compounding",children:"Core Formula (Monthly Compounding)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"FV = PV \xd7 (1 + r)^n + PMT \xd7 [((1 + r)^n - 1) / r]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Where:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"FV"})," = Future Value (Projected Value)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PV"})," = Initial Contributions (starting allocation)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PMT"})," = Monthly Investment Amount"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"r"})," = Monthly Return Rate (annual rate / 12)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n"})," = Number of months from goal start date"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-monthly-compounding",children:"Why Monthly Compounding?"}),"\n",(0,r.jsx)(n.p,{children:"Monthly compounding is used for consistency with the goal form calculation. When\na user creates a goal:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Goal Form"})," calculates required monthly investment using monthly\ncompounding"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Projected Value"})," uses the same monthly compounding formula"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," Projected Future Value at due date = Target Amount (consistent)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If different compounding methods were used, the projected value would not match\nthe target, causing user confusion."}),"\n",(0,r.jsx)(n.h3,{id:"why-not-include-initial-contribution",children:"Why Not Include Initial Contribution?"}),"\n",(0,r.jsxs)(n.p,{children:["Initial contributions represent what you've already allocated at goal start. The\nprojection shows what you ",(0,r.jsx)(n.strong,{children:"expect to achieve through ongoing contributions and\ngrowth"}),", not what you already have."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial allocation: 34,000,000 (locked at goal start)"}),"\n",(0,r.jsx)(n.li,{children:"Monthly contribution: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months elapsed: 1"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Projected should show: ~1,005,833 (from contributions + growth) Not:\n34,000,000 + 1,005,833 (mixing allocated with projected)"}),"\n",(0,r.jsx)(n.h2,{id:"alternative-formula-daily-compounding",children:"Alternative Formula: Daily Compounding"}),"\n",(0,r.jsx)(n.p,{children:"For more accurate real-world projections, daily compounding can be used.\nUnlike monthly compounding, daily compounding calculates projection for any\nspecific date (not just month milestones)."}),"\n",(0,r.jsx)(n.h3,{id:"daily-compounding-formula",children:"Daily Compounding Formula"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"FV_contributions = PMT_daily \xd7 [((1 + r_daily)^n - 1) / r_daily]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Where:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"FV_contributions"})," = Future Value of contributions only"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PMT_daily"})," = Daily Investment Amount (typically back-calculated to reach target)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"r_daily"})," = Daily Return Rate (annual rate / 100 / 365)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n"})," = Number of days from goal start date to target date"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.em,{children:["Note: The ",(0,r.jsx)(n.code,{children:"startValue"})," (Initial Principal) is technically excluded from this specific function's output in the current implementation, as the projection line focuses on the growth of systematic investments."]})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"r_daily"})," = Daily Return Rate (annual rate / 100 / 365)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n"})," = Number of days from goal start date to target date"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"when-to-use-daily-compounding",children:"When to Use Daily Compounding"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"For current-date on-track determination"}),": More precise than monthly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"For any specific date projection"}),": Can calculate for Dec 15, not just Dec 31"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"For daily charts or real-time tracking"}),": Better granularity"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"precision-difference",children:"Precision Difference"}),"\n",(0,r.jsx)(n.p,{children:"Daily vs Monthly compounding for 5 years at 8% annual rate:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Monthly compounding: ",(0,r.jsx)(n.code,{children:"(1 + 0.08/12)^60 = 1.4898"})]}),"\n",(0,r.jsxs)(n.li,{children:["Daily compounding: ",(0,r.jsx)(n.code,{children:"(1 + 0.08/365)^1825 = 1.4917"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Difference: ~0.13% higher with daily compounding (more realistic)"}),"\n",(0,r.jsx)(n.h2,{id:"calculation-details-current-implementation",children:"Calculation Details (Current Implementation)"}),"\n",(0,r.jsx)(n.h3,{id:"1-parameter-conversion",children:"1. Parameter Conversion"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Annual to Monthly Return Rate:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const monthlyRate = annualReturnRate / 100 / 12;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example: 7% annual = 0.583% monthly (7 / 100 / 12 = 0.00583)"}),"\n",(0,r.jsx)(n.h3,{id:"2-time-calculation",children:"2. Time Calculation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const monthsFromStart = differenceInMonths(today, goalStartDate);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Uses date-fns ",(0,r.jsx)(n.code,{children:"differenceInMonths"})," for accurate month difference."]}),"\n",(0,r.jsx)(n.h3,{id:"3-compound-factor",children:"3. Compound Factor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const compoundFactor = Math.pow(1 + monthlyRate, monthsFromStart);\n"})}),"\n",(0,r.jsx)(n.p,{children:"This represents: (1 + r)^n"}),"\n",(0,r.jsx)(n.h3,{id:"4-future-value-calculation",children:"4. Future Value Calculation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"If monthly rate is 0:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"return monthlyInvestment * monthsFromStart;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Simple accumulation of contributions."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"If monthly rate > 0:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const compoundFactor = Math.pow(1 + monthlyRate, monthsFromStart);\nreturn monthlyInvestment * ((compoundFactor - 1) / monthlyRate);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Compound interest formula for regular contributions. Note that detailed implementation excludes ",(0,r.jsx)(n.code,{children:"startValue"})," (Initial Principal) from this specific calculation to isolate the growth of new contributions."]}),"\n",(0,r.jsx)(n.h2,{id:"implementation-locations",children:"Implementation Locations"}),"\n",(0,r.jsx)(n.h3,{id:"1-goal-utilsts---calculateprojectedvalue",children:"1. goal-utils.ts - calculateProjectedValue()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"}),' Calculate projected value for any date, used for chart rendering and "On Track"\ndetermination. Excludes initial contributions per business logic.']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export function calculateProjectedValue(\n  startValue: number,  // NOT USED - kept for backwards compatibility\n  monthlyInvestment: number,\n  annualReturnRate: number,\n  monthsFromStart: number,\n): number {\n  // At goal start date, projected value is 0 (no contributions yet)\n  if (monthsFromStart <= 0) return 0;\n\n  const monthlyRate = annualReturnRate / 100 / 12;\n\n  if (monthlyRate === 0) {\n    // No return: just sum of contributions\n    return monthlyInvestment * monthsFromStart;\n  }\n\n  // Compound interest only from monthly contributions\n  const compoundFactor = Math.pow(1 + monthlyRate, monthsFromStart);\n  const futureContributions = monthlyInvestment * ((compoundFactor - 1) / monthlyRate);\n\n  return futureContributions;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Called from:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"use-goal-progress.ts:"}),' For "On Track" determination']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const monthsFromStart = getMonthsDiff(goalStartDate, today);\nconst projectedValue = calculateProjectedValue(\n  0,  // Initial contributions excluded from projection\n  monthlyInvestment,\n  annualReturnRate,\n  Math.max(0, monthsFromStart),\n);\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"use-goal-valuation-history.ts:"})," For chart data points"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const monthsFromStart = getMonthsDiff(goalStartDate, date);\nconst projected = calculateProjectedValue(\n  0,  // Initial contributions excluded\n  monthlyInvestment,\n  annualReturnRate,\n  Math.max(0, monthsFromStart),\n);\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-goal-utilsts---daily-compounding-functions",children:"2. goal-utils.ts - Daily Compounding Functions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Provide daily-precision projection calculations for on-track\ndetermination and any-date projections."]}),"\n",(0,r.jsx)(n.h4,{id:"getdaysdiffstartdate-enddate",children:(0,r.jsx)(n.code,{children:"getDaysDiff(startDate, endDate)"})}),"\n",(0,r.jsx)(n.p,{children:"Calculates exact number of days between two dates."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"export function getDaysDiff(startDate: Date, endDate: Date): number {\n  const diffTime = Math.abs(endDate.getTime() - startDate.getTime());\n  return Math.floor(diffTime / (1000 * 60 * 60 * 24));\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"calculateprojectedvaluebydatestartvalue-monthlyinvestment-annualreturnrate-startdate-currentdate",children:(0,r.jsx)(n.code,{children:"calculateProjectedValueByDate(startValue, monthlyInvestment, annualReturnRate, startDate, currentDate)"})}),"\n",(0,r.jsxs)(n.p,{children:["Calculates projected value at any specific date using daily compounding.\n",(0,r.jsxs)(n.em,{children:["Note: ",(0,r.jsx)(n.code,{children:"startValue"})," is passed for API consistency but is currently unused in the internal calculation logic."]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Example: Project value for Dec 15 (not just Dec 31)\nconst projected = calculateProjectedValueByDate(\n  startValue: 1000000,      // Passed but unused in projection logic\n  dailyInvestment: 3333,    // Daily contribution\n  annualReturnRate: 7,       // 7% annual\n  startDate: new Date('2025-01-01'),\n  currentDate: new Date('2025-12-15') // Any date\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Formula:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Converts monthly investment to daily: ",(0,r.jsx)(n.code,{children:"dailyInvestment = monthlyInvestment / 30"})]}),"\n",(0,r.jsxs)(n.li,{children:["Daily rate: ",(0,r.jsx)(n.code,{children:"dailyRate = annualReturnRate / 100 / 365"})]}),"\n",(0,r.jsx)(n.li,{children:"Applies compound interest for exact days elapsed"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"isgoalontrackbydatecurrentvalue-startvalue-monthlyinvestment-annualreturnrate-startdate",children:(0,r.jsx)(n.code,{children:"isGoalOnTrackByDate(currentValue, startValue, monthlyInvestment, annualReturnRate, startDate)"})}),"\n",(0,r.jsx)(n.p,{children:"Determines on-track status using daily compounding (more precise than monthly)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const onTrack = isGoalOnTrackByDate(\n  currentValue: 500000,\n  startValue: 1000000,\n  monthlyInvestment: 100000,\n  annualReturnRate: 7,\n  startDate: new Date('2025-01-01')\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-goal-details-pagetsx",children:"4. goal-details-page.tsx"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Display goal details with on-track status."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Single Source of Truth:"})," Uses ",(0,r.jsx)(n.code,{children:"goalProgress.isOnTrack"})," from the hook to\nensure consistency between Goal Card and Goal Details page."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Use goalProgress.isOnTrack as single source of truth (same as Goal Card)\nconst onTrack = goalProgress?.isOnTrack ?? true;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-use-goal-valuation-historyts",children:"5. use-goal-valuation-history.ts"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose:"})," Calculate projected values for all dates in the chart\n(weeks/months/years/all), used for chart rendering."]}),"\n",(0,r.jsx)(n.p,{children:"Uses monthly compounding for consistency, called for each date interval:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const projected = calculateProjectedValue(\n  startValue,\n  monthlyInvestment,\n  annualReturnRate,\n  Math.max(0, monthsFromStart),\n);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"calculation-scenarios",children:"Calculation Scenarios"}),"\n",(0,r.jsx)(n.h3,{id:"scenario-1-no-monthly-investment-no-return",children:"Scenario 1: No Monthly Investment, No Return"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monthly investment: 0"}),"\n",(0,r.jsx)(n.li,{children:"Annual return rate: 0%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 1"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyInvestment = 0\nprojectedValue = 0\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," 0 (no growth without contributions or returns)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"scenario-2-monthly-investment-no-return",children:"Scenario 2: Monthly Investment, No Return"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return rate: 0%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 1"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"projectedValue = 1,000,000 \xd7 1 = 1,000,000\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," 1,000,000 (purely from contributions)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"scenario-3-monthly-investment--return",children:"Scenario 3: Monthly Investment + Return"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return rate: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 1"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyRate = 7 / 100 / 12 = 0.00583\ncompoundFactor = (1 + 0.00583)^1 = 1.00583\nprojectedValue = 1,000,000 \xd7 ((1.00583 - 1) / 0.00583)\n              = 1,000,000 \xd7 1.0\n              = 1,000,000\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," 1,000,000 (first month, minimal compound effect)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"scenario-4-1-year-projection",children:"Scenario 4: 1 Year Projection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return rate: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 12"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyRate = 0.00583\ncompoundFactor = (1.00583)^12 = 1.0723\nprojectedValue = 1,000,000 \xd7 ((1.0723 - 1) / 0.00583)\n              = 1,000,000 \xd7 12.40\n              = 12,400,000\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," 12,400,000 (approximately: 12M from contributions + 400K from\ngrowth)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"scenario-5-multiple-years",children:"Scenario 5: Multiple Years"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial allocation: 34,000,000 (NOT included in projection)"}),"\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return rate: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 24 (2 years)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyRate = 0.00583\ncompoundFactor = (1.00583)^24 = 1.1498\nprojectedValue = 1,000,000 \xd7 ((1.1498 - 1) / 0.00583)\n              = 1,000,000 \xd7 25.69\n              = 25,690,000\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Result:"})," 25,690,000 (only from monthly contributions, not initial allocation)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," The 34M initial allocation affects actual value, not projected value."]}),"\n",(0,r.jsx)(n.h2,{id:"on-track-determination",children:"On-Track Determination"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logic:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"isOnTrack = currentValue >= projectedValue;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Where:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"currentValue"})," = initialContribution + (accountGrowth \xd7 allocatedPercent)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"projectedValue"})," = PMT \xd7 [((1 + r)^n - 1) / r] (using monthly compounding)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Single Source of Truth:"})," The ",(0,r.jsx)(n.code,{children:"goalProgress.isOnTrack"})," from\n",(0,r.jsx)(n.code,{children:"use-goal-progress.ts"})," hook is used by both Goal Card and Goal Details page to\nensure consistency."]}),"\n",(0,r.jsx)(n.h3,{id:"example-on-track",children:"Example: On Track"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Goal start: Jan 1, 2025"}),"\n",(0,r.jsx)(n.li,{children:"Today: Feb 1, 2025 (1 month)"}),"\n",(0,r.jsx)(n.li,{children:"Initial allocation: 34,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Actual account growth: 500,000"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actual value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"currentValue = 34,000,000 + (500,000 \xd7 100%)\n             = 34,500,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Projected value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyRate = 7 / 100 / 12 = 0.00583\ncompoundFactor = (1.00583)^1 = 1.00583\nprojectedValue = 1,000,000 \xd7 ((1.00583 - 1) / 0.00583)\n              = 1,000,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Determination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"34,500,000 >= 1,000,000 \u2192 ON TRACK \u2713\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-off-track",children:"Example: Off Track"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Same setup but:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Actual account growth: -500,000 (loss)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actual value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"currentValue = 34,000,000 + (-500,000 \xd7 100%)\n             = 33,500,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Determination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"33,500,000 >= 1,000,000 \u2192 ON TRACK \u2713 (still on track!)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example with smaller initial allocation:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial allocation: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Monthly investment: 10,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 1"}),"\n",(0,r.jsx)(n.li,{children:"Actual account growth: 0 (no growth)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actual value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"currentValue = 1,000,000 + (0 \xd7 100%)\n             = 1,000,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Projected value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"projectedValue = 10,000 \xd7 1 = 10,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Determination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"1,000,000 >= 10,000 \u2192 ON TRACK \u2713\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example: Truly Off Track"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial allocation: 100,000 (that was supposed to grow)"}),"\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return: 10%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 12"}),"\n",(0,r.jsx)(n.li,{children:"Actual account growth: -50,000 (loss)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actual value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"currentValue = 100,000 + (-50,000 \xd7 100%)\n             = 50,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Projected value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"monthlyRate = 10 / 100 / 12 = 0.00833\ncompoundFactor = (1.00833)^12 = 1.1047\nprojectedValue = 1,000 \xd7 ((1.1047 - 1) / 0.00833)\n              = 1,000 \xd7 12.56\n              = 12,560\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Determination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"50,000 >= 12,560 \u2192 ON TRACK \u2713\n"})}),"\n",(0,r.jsx)(n.p,{children:"(Even with loss, initial allocation keeps it on track)"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example: Truly Off Track (Version 2)"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial allocation: 0 (future-start goal, no allocation yet)"}),"\n",(0,r.jsx)(n.li,{children:"Monthly investment: 1,000,000"}),"\n",(0,r.jsx)(n.li,{children:"Annual return: 7%"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: 1"}),"\n",(0,r.jsx)(n.li,{children:"Actual account growth: 0"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Actual value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"currentValue = 0 + (0 \xd7 100%)\n             = 0\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Projected value:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"projectedValue = 1,000,000\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Determination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"0 >= 1,000,000 \u2192 OFF TRACK \u2717\n"})}),"\n",(0,r.jsx)(n.p,{children:"(Future goal with no allocation yet is off track)"}),"\n",(0,r.jsx)(n.h2,{id:"chart-rendering",children:"Chart Rendering"}),"\n",(0,r.jsx)(n.p,{children:"The projected line on the chart is built by calculating projected value for each\ndate interval."}),"\n",(0,r.jsx)(n.h3,{id:"date-intervals",children:"Date Intervals"}),"\n",(0,r.jsx)(n.p,{children:"Based on time period selected:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Weeks:"})," Every end-of-week from goal start to due date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Months:"})," Every end-of-month from goal start to due date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Years:"})," Every end-of-year from goal start to due date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"All:"})," Yearly intervals across entire goal timeline"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"chart-data-points",children:"Chart Data Points"}),"\n",(0,r.jsx)(n.p,{children:"For each date interval:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'{\n  date: "2025-02-01",\n  dateLabel: "Feb \'25",\n  projected: 1020321,  // Calculated for end of period\n  actual: 34500000     // Historical account value (if available)\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"handling-incomplete-periods",children:"Handling Incomplete Periods"}),"\n",(0,r.jsxs)(n.p,{children:["For the ",(0,r.jsx)(n.strong,{children:"current period"})," (which hasn't ended yet):"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Current Logic (as of implementation):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If actual data available on or before the period end date: Use it"}),"\n",(0,r.jsx)(n.li,{children:"If NOT available AND it's the current period: Use latest known value"}),"\n",(0,r.jsx)(n.li,{children:"If future period: Show null (no actual data)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example (December, current date is Dec 15):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Period end date: Dec 31 (future)"}),"\n",(0,r.jsx)(n.li,{children:"Latest actual value: Dec 15 (today)"}),"\n",(0,r.jsx)(n.li,{children:'Chart displays: Dec 15 value marked as "Dec" data point'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Code:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Lines 470-480 in use-goal-valuation-history.ts\nif (actual === null && latestActualValue !== null) {\n  const isSamePeriod =\n    (period === "weeks" && format(date, "yyyy-ww") === format(today, "yyyy-ww")) ||\n    (period === "months" && format(date, "yyyy-MM") === format(today, "yyyy-MM")) ||\n    (period === "years" && format(date, "yyyy") === format(today, "yyyy")) ||\n    (period === "all" && format(date, "yyyy") === format(today, "yyyy"));\n\n  if (isSamePeriod) {\n    actual = latestActualValue;  // Use today\'s value for current period\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"projected-vs-actual-lines",children:"Projected vs Actual Lines"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Projected (dashed line):"})," Uses monthly compounding, calculated at period end dates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Actual (solid line):"})," Historical values from account valuations, latest value used for current incomplete period"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"special-cases",children:"Special Cases"}),"\n",(0,r.jsx)(n.h3,{id:"case-1-goal-not-started-yet",children:"Case 1: Goal Not Started Yet"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Goal start date: 2026-01-01"}),"\n",(0,r.jsx)(n.li,{children:"Today: 2025-12-16"}),"\n",(0,r.jsx)(n.li,{children:"Months from start: negative"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Handling:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"if (monthsFromStart <= 0) return 0;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Projected value = 0 (goal hasn't started)"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"case-2-no-monthly-investment",children:"Case 2: No Monthly Investment"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monthly investment: 0"}),"\n",(0,r.jsx)(n.li,{children:"Any return rate"}),"\n",(0,r.jsx)(n.li,{children:"Any months"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Calculation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"projectedValue = 0\n"})}),"\n",(0,r.jsx)(n.p,{children:"Projected value = 0 (only from contributions)"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"case-3-negative-return-rate",children:"Case 3: Negative Return Rate"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Not supported by business logic."})," Return rates are typically 0-20%. Negative\nreturns should be handled as 0 or require separate loss calculation."]}),"\n",(0,r.jsx)(n.h2,{id:"data-dependencies",children:"Data Dependencies"}),"\n",(0,r.jsx)(n.h3,{id:"use-goal-progressts",children:"use-goal-progress.ts"}),"\n",(0,r.jsx)(n.p,{children:"Requires:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.monthlyInvestment"})," \u2014 Monthly contribution amount"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.targetReturnRate"})," \u2014 Annual return percentage (0-100)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.startDate"})," \u2014 Goal start date (ISO string)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Provides:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goalProgress.projectedValue"})," \u2014 Projected value at today's date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goalProgress.isOnTrack"})," \u2014 Boolean: currentValue >= projectedValue"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"use-goal-valuation-historyts",children:"use-goal-valuation-history.ts"}),"\n",(0,r.jsx)(n.p,{children:"Requires:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.monthlyInvestment"})," \u2014 Monthly contribution amount"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.targetReturnRate"})," \u2014 Annual return percentage (0-100)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.startDate"})," \u2014 Goal start date (ISO string)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"goal.dueDate"})," \u2014 Goal due date (ISO string)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Provides:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"chartData[].projected"})," \u2014 Projected value for each date interval"]}),"\n",(0,r.jsx)(n.li,{children:"Used in chart rendering and visual comparison with actual values"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,r.jsx)(n.h3,{id:"1-monthly-investment-range",children:"1. Monthly Investment Range"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"0 <= monthlyInvestment <= account_balance\n"})}),"\n",(0,r.jsx)(n.p,{children:"Can be 0 (no contributions expected)."}),"\n",(0,r.jsx)(n.h3,{id:"2-annual-return-rate-range",children:"2. Annual Return Rate Range"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"0 <= annualReturnRate <= 100\n"})}),"\n",(0,r.jsx)(n.p,{children:"Typically 0-20% for realistic scenarios."}),"\n",(0,r.jsx)(n.h3,{id:"3-start-date-before-due-date",children:"3. Start Date Before Due Date"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"goal.startDate < goal.dueDate\n"})}),"\n",(0,r.jsx)(n.p,{children:"Ensure goal timeline makes sense."}),"\n",(0,r.jsx)(n.h3,{id:"4-projected-value-constraints",children:"4. Projected Value Constraints"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"projectedValue >= 0\n"})}),"\n",(0,r.jsx)(n.p,{children:"Always non-negative (can't have negative projected value without losses)."}),"\n",(0,r.jsx)(n.h2,{id:"testing-scenarios",children:"Testing Scenarios"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u2713 Goal with zero monthly investment \u2192 projected = 0"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Goal with zero return rate \u2192 projected = sum of contributions"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Goal with 0% monthly + 7% return \u2192 projected = 0"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Goal with contributions + return \u2192 compound interest applied"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Goal not started yet \u2192 projected = 0"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Goal active for 1 year \u2192 verify against manual calculation"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 On-track determination \u2192 currentValue >= projectedValue"}),"\n",(0,r.jsx)(n.li,{children:"\u2713 Chart data points \u2192 verify intervals match selected period"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/lib/date-utils.ts"})," \u2014 Date calculation utilities"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"getMonthsDiff()"})," \u2014 Calculate months between dates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"formatTimeRemaining()"})," \u2014 Format time to due date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"formatTimeElapsed()"})," \u2014 Format time since start date"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/pages/goals/lib/goal-utils.ts"})," \u2014 Goal calculation and status utilities"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"calculateProjectedValue()"})," \u2014 Monthly compounding projection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"calculateProjectedValueByDate()"})," \u2014 Daily compounding projection for any date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"getDaysDiff()"})," \u2014 Calculate days between dates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"isGoalOnTrack()"})," \u2014 Compare current vs monthly-projected value"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"isGoalOnTrackByDate()"})," \u2014 Compare current vs daily-projected value"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"isGoalScheduled()"})," \u2014 Check if goal is future-scheduled"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"getGoalStatus()"})," \u2014 Get UI status display"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/pages/goals/use-goal-progress.ts"})," \u2014 Main hook for goal progress and\non-track determination"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/pages/goals/use-goal-valuation-history.ts"})," \u2014 Chart data generation with\nmonthly compounding projections"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/pages/goals/goal-details-page.tsx"})," \u2014 Goal details page (uses\ngoalProgress.isOnTrack as single source)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"src/pages/goals/components/goal-form.tsx"})," \u2014 Goal form (calculates monthly\ninvestment using same formula)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"docs/goal-actual-growth-business-logic.md"})," \u2014 Actual value calculation logic"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8193(e,n,t){t.d(n,{R:()=>i,x:()=>a});var l=t(758);const r={},s=l.createContext(r);function i(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);