"use strict";(self.webpackChunkwealthvn_docs=self.webpackChunkwealthvn_docs||[]).push([[4803],{7593(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"development/goals/goal-details-page","title":"Goal Detail Page","description":"This document describes the structure, components, and logic of the Goal Detail Page (src/pages/goals/goal-details-page.tsx). This page provides an immersive view of a specific financial goal, tracking its progress, projected growth, and allocations.","source":"@site/docs/development/goals/goal-details-page.md","sourceDirName":"development/goals","slug":"/development/goals/goal-details-page","permalink":"/wealth-vn/docs/development/goals/goal-details-page","draft":false,"unlisted":false,"editUrl":"https://github.com/chipheo00/vn-wealthfolio/tree/main/docs/docs/development/goals/goal-details-page.md","tags":[],"version":"current","frontMatter":{"id":"goal-details-page","title":"Goal Detail Page","sidebar_label":"Goal Detail Page"},"sidebar":"tutorialSidebar","previous":{"title":"Goal Actual Growth Business Logic","permalink":"/wealth-vn/docs/development/goals/goal-actual-growth-business-logic"},"next":{"title":"Projected Value Business Logic","permalink":"/wealth-vn/docs/development/goals/projected-value-business-logic"}}');var i=t(6070),s=t(8193);const a={id:"goal-details-page",title:"Goal Detail Page",sidebar_label:"Goal Detail Page"},r="Goal Detail Page",o={},d=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Details",id:"details",level:3},{value:"Page Structure",id:"page-structure",level:2},{value:"1. Header",id:"1-header",level:3},{value:"2. Main Grid",id:"2-main-grid",level:3},{value:"3. Allocations Section",id:"3-allocations-section",level:3},{value:"Key Components",id:"key-components",level:2},{value:"1. Growth Projection Chart",id:"1-growth-projection-chart",level:3},{value:"Logic &amp; Calculations",id:"logic--calculations",level:4},{value:"Time Periods",id:"time-periods",level:4},{value:"2. MetricDisplay",id:"2-metricdisplay",level:3},{value:"3. AllocationHistoryTable",id:"3-allocationhistorytable",level:3},{value:"4. EditAllocationsModal",id:"4-editallocationsmodal",level:3},{value:"Data Fetching &amp; Logic",id:"data-fetching--logic",level:2},{value:"Data Sources",id:"data-sources",level:3},{value:"Core Calculations",id:"core-calculations",level:3},{value:"1. Daily Investment (Reverse Engineering)",id:"1-daily-investment-reverse-engineering",level:4},{value:"2. Projected Value",id:"2-projected-value",level:4},{value:"3. On-Track Status",id:"3-on-track-status",level:4},{value:"User Interactions",id:"user-interactions",level:2},{value:"Data Flow Diagram",id:"data-flow-diagram",level:2},{value:"Page Data Flow",id:"page-data-flow",level:3},{value:"Chart Data Flow",id:"chart-data-flow",level:3},{value:"Goal Progress Flow",id:"goal-progress-flow",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"goal-detail-page",children:"Goal Detail Page"})}),"\n",(0,i.jsxs)(n.p,{children:["This document describes the structure, components, and logic of the ",(0,i.jsx)(n.strong,{children:"Goal Detail Page"})," (",(0,i.jsx)(n.code,{children:"src/pages/goals/goal-details-page.tsx"}),"). This page provides an immersive view of a specific financial goal, tracking its progress, projected growth, and allocations."]}),"\n",(0,i.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#page-structure",children:"Page Structure"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#key-components",children:"Key Components"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#data-fetching--logic",children:"Data Fetching & Logic"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#user-interactions",children:"User Interactions"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The Goal Detail Page is designed to answer three key questions for the user:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:'"How am I doing?"'})," (Progress, On Track/Off Track status)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:'"Will I reach my goal?"'})," (Growth Projection Chart)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:'"How am I funding this?"'})," (Allocations)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"details",children:"Details"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"When user create a goal with minimal info: (Name, Target Amount,Return Rate, Start Date, Due Date), the system will calculate the monthly investment based on the goal's duration, target amount, and return rate."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Initial the allocations will be set as 0 for all accounts."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"When user open the Goal detail page, user can see the Overview card, Growth Projection Chart, and Allocations section."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Chart details:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Projected and actual value should be calculate by date."}),"\n",(0,i.jsxs)(n.li,{children:["Projected line:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Show the projected value depend on period selected, using the compounding formula for month."}),"\n",(0,i.jsx)(n.li,{children:"In chart, projected line start on goal start date (initial value = daily investment) and end on goal due date(value ~ goal target amount)."}),"\n",(0,i.jsx)(n.li,{children:"In weeks period, the projected line will be show the projected value depend on period selected, and the compounding formula for date(end of weeks)."}),"\n",(0,i.jsx)(n.li,{children:"In months period, the projected line will be show the projected value depend on period selected, and the compounding formula for date(end of months)."}),"\n",(0,i.jsx)(n.li,{children:"In years period, the projected line will be show the projected value depend on period selected, and the compounding formula for date(end of years)."}),"\n",(0,i.jsx)(n.li,{children:"In all period, the projected line will be show the projected value depend on period selected, and the compounding formula for date(end of all)."}),"\n",(0,i.jsx)(n.li,{children:"The last point's projected value on chart = the Projected future value in Overview card and Projected future value should be changed following the time period selected."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actual line"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Show the actual value depend on period selected."}),"\n",(0,i.jsx)(n.li,{children:"In chart, the current week, month or year value should be equal Current Progress value in Overview card."}),"\n",(0,i.jsxs)(n.li,{children:["In chart, actual line start on goal start date (initial value = ",(0,i.jsx)(n.code,{children:"initialContribution"}),") and end on current date."]}),"\n",(0,i.jsx)(n.li,{children:"Actual Value = Initial Contribution + (Account Growth \xd7 Allocation %)."}),"\n",(0,i.jsx)(n.li,{children:"The last point's actual value on chart = the Current Progress value in Overview card (logic ensures consistency)."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Chart progress status. We have status for goal is on track or off track. The logic is: ",(0,i.jsx)(n.code,{children:"if today's actual value >= projected value -> goal is on track"}),". The color of actual line will be green if on track and red/amber if off track."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Overview card"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Target Amount"}),": Large display of the goal's target."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current Progress"}),": Percentage completion and current contributed value (Total Value)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metrics Grid"}),": Compact 2x2 grid showing:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monthly Investment (DCA)"}),": The monthly contribution amount set on the goal."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Target Return Rate"}),": User input annual return rate."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Time Remaining"}),": Calculated time until proper Due Date."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Projected Future Value"}),": Value calculated using daily compounding of contributions at the selected period end date."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This is example of goal: Mua nha, 1,000,000,000, 8%, 5 year, 1/1/2025, 1/1/2030, Initial 200,000,000."}),"\n",(0,i.jsx)(n.li,{children:"The system back-calculates the required daily investment to bridge the gap between (Initial + Growth) and Target."}),"\n",(0,i.jsx)(n.li,{children:"The projected future value displayed will be the Target Amount minus the projected growth of the Initial Principal (since projection line tracks contributions)."}),"\n",(0,i.jsx)(n.li,{children:"Current Progress shows the Total Actual Value (Initial + Growth)."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"page-structure",children:"Page Structure"}),"\n",(0,i.jsx)(n.p,{children:"The page uses a responsive layout with the following sections:"}),"\n",(0,i.jsx)(n.h3,{id:"1-header",children:"1. Header"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Title & Description"}),": Displays the goal's name and description."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Edit Goal"}),": Opens the ",(0,i.jsx)(n.code,{children:"GoalEditModal"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Back"}),": Navigates back to the main goals list."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-main-grid",children:"2. Main Grid"}),"\n",(0,i.jsx)(n.p,{children:"A responsive grid layout (2 columns on desktop for the chart, 1 column for overview stats)."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Left/Center (Desktop): Growth Projection Chart"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Displays a visual comparison between "Actual Value" and "Projected Growth" over time.'}),"\n",(0,i.jsx)(n.li,{children:"Allows toggling time periods (Weeks, Months, Years, All)."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Right (Desktop): Overview Card"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Target Amount"}),": Large display of the goal's target."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current Progress"}),": Percentage completion and current currency value."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metrics Grid"}),": Compact 2x2 grid showing:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Monthly Investment"}),"\n",(0,i.jsx)(n.li,{children:"Target Return Rate"}),"\n",(0,i.jsx)(n.li,{children:"Time Remaining"}),"\n",(0,i.jsx)(n.li,{children:"Projected Future Value"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-allocations-section",children:"3. Allocations Section"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Allocation Settings"}),": A read-only Gantt-style view of how this goal is funded across accounts."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current Allocations"}),": A detailed table (",(0,i.jsx)(n.code,{children:"AllocationHistoryTable"}),") listing individual allocation records, allowing users to edit amount/percentage or delete allocations."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,i.jsx)(n.h3,{id:"1-growth-projection-chart",children:"1. Growth Projection Chart"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Library"}),": ",(0,i.jsx)(n.code,{children:"recharts"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type"}),": ",(0,i.jsx)(n.code,{children:"AreaChart"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Hook"}),": ",(0,i.jsx)(n.code,{children:"useGoalValuationHistory"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Features"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Projected Area"}),": Dashed line indicating the ideal path to the target."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actual Area"}),": Solid line (green/amber) showing real progress."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Gradient Fills"}),": Adds depth to the chart areas."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tooltip"}),": Custom tooltip showing values at specific dates."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Color Logic"}),': The "Actual" line color changes based on on-track status (Green if on track, Amber if off track).']}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"logic--calculations",children:"Logic & Calculations"}),"\n",(0,i.jsx)(n.p,{children:"The chart combines two distinct data sets into a unified time series:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Projected Value (Ideal Path)"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Calculated using a ",(0,i.jsx)(n.strong,{children:"daily compounding"})," formula to generate a smooth curve."]}),"\n",(0,i.jsxs)(n.li,{children:["Starts from 0 (at Goal Start Date) and grows based on ",(0,i.jsx)(n.code,{children:"monthlyInvestment"})," and ",(0,i.jsx)(n.code,{children:"targetReturnRate"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Formula"}),": ",(0,i.jsx)(n.code,{children:"FV = PMT \xd7 [((1 + r)^n - 1) / r]"})," (where contributions are monthly/daily equivalents)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Actual Value (Real Progress)"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Aggregated from historical account valuations (",(0,i.jsx)(n.code,{children:"getHistoricalValuations"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Derived using the ",(0,i.jsx)(n.strong,{children:"proportional growth attribution"})," method:\n",(0,i.jsx)(n.code,{children:"Allocated Value = Initial Contribution + (Account Growth \xd7 Allocation %)"})]}),"\n",(0,i.jsx)(n.li,{children:"Points are fetched for the entire relevant history and then aggregated by the selected time period (e.g., end-of-week, end-of-month)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"time-periods",children:"Time Periods"}),"\n",(0,i.jsxs)(n.p,{children:["The hook ",(0,i.jsx)(n.code,{children:"useGoalValuationHistory"})," handles data aggregation based on the selected period:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Period"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Logic"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Range"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Weeks"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"End-of-week values"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"+/- 12 weeks from today"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Months"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"End-of-month values"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"+/- 12 months from today"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Years"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"End-of-year values"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"+/- 3-5 years from today"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"All"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Yearly intervals"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"From Goal Start Date to Due Date"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),': For the "All" view, the chart ensures the exact ',(0,i.jsx)(n.strong,{children:"Goal Due Date"})," is included as the final data point to show the target completion value."]}),"\n",(0,i.jsx)(n.h3,{id:"2-metricdisplay",children:"2. MetricDisplay"}),"\n",(0,i.jsx)(n.p,{children:"A reusable component for showing key-value pairs in the Overview Card."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Used for: Monthly Investment, Return Rate, Time Remaining, etc."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-allocationhistorytable",children:"3. AllocationHistoryTable"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Displays the list of accounts funding this goal."}),"\n",(0,i.jsx)(n.li,{children:'Shows "Initial Contribution", "Allocated %", and calculated "Contributed Value".'}),"\n",(0,i.jsxs)(n.li,{children:["Provides ",(0,i.jsx)(n.code,{children:"Edit"})," and ",(0,i.jsx)(n.code,{children:"Delete"})," actions for each allocation."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"4-editallocationsmodal",children:"4. EditAllocationsModal"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A modal for adding or modifying allocations."}),"\n",(0,i.jsxs)(n.li,{children:["Logic includes:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Validating 100% allocation items cap."}),"\n",(0,i.jsx)(n.li,{children:"Checking available unallocated balance."}),"\n",(0,i.jsx)(n.li,{children:"Prefilling existing values."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"data-fetching--logic",children:"Data Fetching & Logic"}),"\n",(0,i.jsx)(n.h3,{id:"data-sources",children:"Data Sources"}),"\n",(0,i.jsx)(n.p,{children:"The page relies on several React Query hooks:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useQuery([QueryKeys.GOALS])"}),": Fetches the specific goal details."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useQuery([QueryKeys.GOALS_ALLOCATIONS])"}),": Fetches allocation records."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useLatestValuations(accountIds)"}),": Fetches real-time account balances to calculate current value."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useGoalValuationHistory"}),": A specialized hook that generates the time-series data for the chart."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"core-calculations",children:"Core Calculations"}),"\n",(0,i.jsx)(n.h4,{id:"1-daily-investment-reverse-engineering",children:"1. Daily Investment (Reverse Engineering)"}),"\n",(0,i.jsxs)(n.p,{children:["To determine if a goal is on track, the system first calculates the required daily investment to hit the target by the due date.\n",(0,i.jsx)(n.strong,{children:"Crucially"}),", this calculation ",(0,i.jsx)(n.em,{children:"does"})," account for the ",(0,i.jsx)(n.code,{children:"startValue"})," (Initial Principal). It finds the contribution needed to fill the gap between the Target and the Future Value of the Initial Principal."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const dailyInvestment = calculateDailyInvestment(\n  startValue,\n  goal.targetAmount,\n  annualReturnRate,\n  startDate,\n  dueDate,\n  // Formula: Amount needed to fill (Target - FutureValue(Start))\n);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-projected-value",children:"2. Projected Value"}),"\n",(0,i.jsxs)(n.p,{children:["Using the calculated daily investment, we project the growth of ",(0,i.jsx)(n.em,{children:"future contributions"})," to today's date (or any chart date).\n",(0,i.jsxs)(n.em,{children:["Note: The ",(0,i.jsx)(n.code,{children:"calculateProjectedValueByDate"})," function calculates the accumulated value of these daily investments only."]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"projectedValueToday = calculateProjectedValueByDate(\n  startValue, // Passed but unused in this specific function\n  dailyInvestment,\n  annualReturnRate,\n  startDate,\n  today,\n);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-on-track-status",children:"3. On-Track Status"}),"\n",(0,i.jsx)(n.p,{children:"A simple comparison determines the status color (Green/Amber):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'onTrack = currentAmount >= projectedValueToday;\nconst actualColor = onTrack ? "var(--chart-actual-on-track)" : "var(--chart-actual-off-track)";\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"user-interactions",children:"User Interactions"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Action"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Change Time Period"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Clicking the toggle (Weeks/Months/Years) updates the ",(0,i.jsx)(n.code,{children:"timePeriod"})," state, triggering ",(0,i.jsx)(n.code,{children:"useGoalValuationHistory"})," to re-aggregate data."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Edit Goal"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Opens ",(0,i.jsx)(n.code,{children:"GoalEditModal"})," to update title, target, dates, etc."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Edit Allocations"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Opens ",(0,i.jsx)(n.code,{children:"EditAllocationsModal"})," to change funding sources."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.strong,{children:"Delete Allocation"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Clicking the trash icon in ",(0,i.jsx)(n.code,{children:"AllocationHistoryTable"})," calls ",(0,i.jsx)(n.code,{children:"deleteAllocationMutation"})," to remove funding."]})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"data-flow-diagram",children:"Data Flow Diagram"}),"\n",(0,i.jsx)(n.p,{children:"This section illustrates how data flows through the Goal Detail Page frontend."}),"\n",(0,i.jsx)(n.h3,{id:"page-data-flow",children:"Page Data Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TB\n    subgraph Hooks["Data Hooks"]\n        H_Goals["useQuery(GOALS)"]\n        H_Alloc["useQuery(GOALS_ALLOCATIONS)"]\n        H_Accounts[useAccounts]\n        H_Latest[useLatestValuations]\n        H_Progress[useGoalProgress]\n        H_ValHist[useGoalValuationHistory]\n    end\n\n    subgraph Page["GoalDetailsPage"]\n        STATE[/"timePeriod state"/]\n        CALC["Calculate projections & on-track status"]\n    end\n\n    subgraph Components["UI Components"]\n        CHART[Growth Projection Chart]\n        OVERVIEW[Overview Card]\n        GANTT[Allocation Settings]\n        TABLE[Allocation History Table]\n    end\n\n    H_Goals --\x3e Page\n    H_Alloc --\x3e Page\n    H_Accounts --\x3e H_Latest\n    H_Latest --\x3e Page\n    H_Goals --\x3e H_Progress\n    H_Alloc --\x3e H_Progress\n    H_Progress --\x3e Page\n    STATE --\x3e H_ValHist\n    H_ValHist --\x3e CHART\n\n    Page --\x3e CALC\n    CALC --\x3e OVERVIEW\n    Page --\x3e GANTT\n    Page --\x3e TABLE'}),"\n",(0,i.jsx)(n.h3,{id:"chart-data-flow",children:"Chart Data Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart LR\n    subgraph Input\n        GOAL[Goal]\n        PERIOD[Time Period]\n        ALLOCS[Allocations]\n        HIST_VALS[Historical Valuations]\n    end\n\n    subgraph Processing["useGoalValuationHistory"]\n        GEN_DATES[Generate Date Intervals]\n        CALC_ACTUAL[Calculate Actual Values]\n        CALC_PROJ[Calculate Projected Values]\n        BUILD[Build Chart Data Points]\n    end\n\n    subgraph Output\n        CHART_DATA["chartData[]"]\n    end\n\n    GOAL --\x3e GEN_DATES\n    PERIOD --\x3e GEN_DATES\n    ALLOCS --\x3e CALC_ACTUAL\n    HIST_VALS --\x3e CALC_ACTUAL\n    GEN_DATES --\x3e BUILD\n    CALC_ACTUAL --\x3e BUILD\n    GOAL --\x3e CALC_PROJ\n    CALC_PROJ --\x3e BUILD\n    BUILD --\x3e CHART_DATA'}),"\n",(0,i.jsx)(n.h3,{id:"goal-progress-flow",children:"Goal Progress Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart LR\n    subgraph Input\n        GOALS[Goals]\n        ALLOCS[Allocations]\n        VALS[Latest Valuations]\n    end\n\n    subgraph Processing["useGoalProgress"]\n        FILTER[Filter by Goal]\n        CALC_VAL["Calculate Current Value"]\n        CALC_TRACK[Determine On-Track Status]\n    end\n\n    subgraph Output\n        PROGRESS[GoalProgress]\n    end\n\n    GOALS --\x3e FILTER\n    ALLOCS --\x3e FILTER\n    VALS --\x3e CALC_VAL\n    FILTER --\x3e CALC_VAL\n    CALC_VAL --\x3e CALC_TRACK\n    CALC_TRACK --\x3e PROGRESS'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/wealth-vn/docs/development/goals/goal-page-logic",children:"Goal Page Business Logic"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/wealth-vn/docs/development/goals/projected-value-business-logic",children:"Projected Value Business Logic"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8193(e,n,t){t.d(n,{R:()=>a,x:()=>r});var l=t(758);const i={},s=l.createContext(i);function a(e){const n=l.useContext(s);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);